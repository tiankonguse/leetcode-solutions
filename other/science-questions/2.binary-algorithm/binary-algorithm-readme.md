# 二分算法（二分答案/最小化最大值/最大化最小值/第K小）


## 一、二分查找

### §1.1 基础

- [X]  34. 在排序数组中查找元素的第一个和最后一个位置
- [X]  35. 搜索插入位置
- [X]  704. 二分查找
- [X]  744. 寻找比目标字母大的最小字母
- [X]  2529. 正整数和负整数的最大计数

### §1.2 进阶

部分题目需要先排序，然后在有序数组上二分查找。

- [X] 2300. 咒语和药水的成功对数 1477
- [X] 1385. 两个数组间的距离值
- [X] 2389. 和有限的最长子序列
- [X] 1170. 比较字符串最小字母出现频次
- [X] 2080. 区间内查询数字的频率 1702
- [X] 3488. 距离最小相等元素查询 做法不止一种
- [X] 2563. 统计公平数对的数目 1721
- [X] 2070. 每一个查询的最大美丽值 1724
- [X] 1146. 快照数组 1771
- [X] 981. 基于时间的键值存储 同 1146 题
- [X] 3508. 设计路由器 ~1800
- [X] 658. 找到 K 个最接近的元素
- [X] 1818. 绝对差值和 1934
- [X] 911. 在线选举 2001
- [X] LCP 08. 剧情触发时间
- [ ] 1182. 与目标颜色间的最短距离（会员题）
- [ ] 2819. 购买巧克力后的最小相对损失（会员题）

思维扩展：

- [X]  1287. 有序数组中出现次数超过 25% 的元素 做到 O(logn)
- [ ]  1150. 检查一个数是否在数组中占绝大多数（会员题）

## 二、二分答案

> 花费一个 log 的时间，增加了一个条件。 —— 二分答案

### §2.1 求最小

题目求什么，就二分什么。


```cpp
ll l = 0, r = totalTrips * time.front();  // [l, r) 000111
auto Check = [&](ll mid) -> bool {
  ll sum = 0;
  for (auto t : time) {
    sum += mid / t;
  }
  return sum >= totalTrips;
};
while (l < r) {
  ll mid = (l + r) / 2;
  if (Check(mid)) {
    r = mid;
  } else {
    l = mid + 1;
  }
}
return l;
```

#### 答疑

问：如何把二分答案与数组上的二分查找联系起来？
答：假设范围是 `[2,3,4,5]`，我们相当于在一个虚拟数组 `[check(2),check(3),check(4),check(5)]` 中二分找第一个（或者最后一个）值为 true 的 check(i)。这同样可以用红蓝染色法思考。

问：有些题目，明明 m 可以是答案，但却不在初始二分区间中。比如闭区间二分初始化 right=m−1（或者开区间 right=m），这不会算错吗？
答：不会算错。想一想，如果二分的 while 循环每次更新的都是 left，那么最终答案是什么？正好就是 m。一般地，如果一开始就能确定 m 一定可以满足题目要求，那么 m 是不需要在二分区间中的。换句话说，二分区间是「尚未确定是否满足题目要求」的数的范围。那些在区间外面的数，都是已确定的满足（不满足）题目要求的数。

问：什么是循环不变量？
答：想一想，对于求最小的题目，开区间二分的写法，为什么最终返回的是 right，而不是别的数？在初始化（循环之前）、循环中、循环结束后，都时时刻刻保证 check(right) == true 和 check(left) == false，这就叫循环不变量。根据循环不变量，循环结束时 left + 1 == right，那么 right 就是最小的满足要求的数（因为再 −1 就不满足要求了），所以答案是 right。

注：部分题目可以优化二分边界，减少二分次数，从而减少代码运行时间。对于初次接触二分答案的同学，无需强求自己写出最优的代码，设定一个比较大的二分上界也是可以的。

- [X]  1283. 使结果不超过阈值的最小除数 1542
- [X]  2187. 完成旅途的最少时间 1641
- [ ]  1011. 在 D 天内送达包裹的能力 1725
- [ ]  875. 爱吃香蕉的珂珂 1766
- [ ]  3296. 移山所需的最少秒数 注：由于有其他做法，难度分会低一些，二分做法估计 1850
- [ ]  475. 供暖器
- [ ]  2594. 修车的最少时间 1915
- [ ]  1482. 制作 m 束花所需的最少天数 1946
- [ ]  3048. 标记所有下标的最早秒数 I 2263
- [ ]  2604. 吃掉所有谷子的最短时间（会员题）
- [ ]  2702. 使数字变为非正数的最小操作次数（会员题）

思维扩展：

- [ ]  1870. 准时到达的列车最小时速 1676 避免浮点数
- [ ]  3453. 分割正方形 I 1735 浮点二分（也可以避免浮点数）

### §2.2 求最大

一图掌握二分答案！四种写法！

在练习时，请注意「求最小」和「求最大」的二分写法上的区别。

前面的「求最小」和二分查找求「排序数组中某元素的第一个位置」是类似的，按照红蓝染色法，左边是不满足要求的（红色），右边则是满足要求的（蓝色）。

「求最大」的题目则相反，左边是满足要求的（蓝色），右边是不满足要求的（红色）。这会导致二分写法和上面的「求最小」有一些区别。

以开区间二分为例：

- 求最小：check(mid) == true 时更新 right = mid，反之更新 left = mid，最后返回 right。
- 求最大：check(mid) == true 时更新 left = mid，反之更新 right = mid，最后返回 left。

对于开区间写法，简单来说 check(mid) == true 时更新的是谁，最后就返回谁。相比其他二分写法，开区间写法不需要思考加一减一等细节，推荐使用开区间写二分。

- [ ]  275. H 指数 II
- [ ]  2226. 每个小孩最多能分到多少糖果 1646
- [ ]  2982. 找出出现至少三次的最长特殊子字符串 II 1773
- [ ]  2576. 求出最多标记下标 1843
- [ ]  1898. 可移除字符的最大数目 1913
- [ ]  1802. 有界数组中指定下标处的最大值 1929
- [ ]  1642. 可以到达的最远建筑 1962
- [ ]  2861. 最大合金数 1981
- [ ]  3007. 价值和小于等于 K 的最大数字 2258
- [ ]  2141. 同时运行 N 台电脑的最长时间 2265
- [ ]  2258. 逃离火灾 2347
- [ ]  2071. 你可以安排的最多任务数目 2648
- [ ]  LCP 78. 城墙防线
- [ ]  1618. 找出适应屏幕的最大字号（会员题）
- [ ]  1891. 割绳子（会员题）
- [ ]  2137. 通过倒水操作让所有的水桶所含水量相等（会员题）
- [ ]  644. 子数组最大平均数 II（会员题）

### §2.3 二分间接值

二分的不是答案，而是一个和答案有关的值（间接值）。

- [ ]  3143. 正方形中的最多点数 1697
- [ ]  1648. 销售价值减少的颜色球 2050

### §2.4 最小化最大值

本质是二分答案求最小。二分的 mid 表示上界。

- [ ]  410. 分割数组的最大值
- [ ]  2064. 分配给商店的最多商品的最小值 1886
- [ ]  1760. 袋子里最少数目的球 1940
- [ ]  1631. 最小体力消耗路径 1948
- [ ]  2439. 最小化数组中的最大值 1965
- [ ]  2560. 打家劫舍 IV 2081
- [ ]  778. 水位上升的泳池中游泳 2097 相当于最小化路径最大值
- [ ]  2616. 最小化数对的最大差值 2155
- [ ]  3419. 图的最大边权的最小值 2243
- [ ]  2513. 最小化两个数组中的最大值 2302
- [ ]  3399. 字符相同的最短子字符串 II 2376
- [ ]  LCP 12. 小张刷题计划
- [ ]  774. 最小化去加油站的最大距离（会员题）

### §2.5 最大化最小值

本质是二分答案求最大。二分的 mid 表示下界。

- [ ]  3281. 范围内整数的最大得分 1768
- [ ]  2517. 礼盒的最大甜蜜度 2021
- [ ]  1552. 两球之间的磁力 同 2517 题
- [ ]  2812. 找出最安全路径 2154
- [ ]  2528. 最大化城市的最小电量 2236
- [ ]  3449. 最大化游戏分数的最小值 2748
- [ ]  3464. 正方形上的点之间的最大距离 2806
- [ ]  1102. 得分最高的路径（会员题）
- [ ]  1231. 分享巧克力（会员题）

### §2.6 第 K 小/大

例如数组 [1,1,1,2,2]，其中第 1 小、第 2 小和第 3 小的数都是 1，第 4 小和第 5 小的数都是 2。

- 第 k 小等价于：求最小的 x，满足 ≤x 的数至少有 k 个。
- 第 k 大等价于：求最大的 x，满足 ≥x 的数至少有 k 个。

注 1：一般规定 k 从 1 开始，而不是像数组下标那样从 0 开始。

注 2：部分题目也可以用堆解决。

- [ ]  668. 乘法表中第 K 小的数
- [ ]  378. 有序矩阵中第 K 小的元素
- [ ]  719. 找出第 K 小的数对距离
- [ ]  878. 第 N 个神奇数字 1897
- [ ]  1201. 丑数 III 2039
- [ ]  793. 阶乘函数后 K 个零 2100
- [ ]  373. 查找和最小的 K 对数字
- [ ]  1439. 有序矩阵中的第 k 个最小数组和 2134
- [ ]  786. 第 K 个最小的质数分数 2169
- [ ]  3116. 单面值组合的第 K 小金额 2387
- [ ]  3134. 找出唯一性数组的中位数 2451
- [ ]  2040. 两个有序数组的第 K 小乘积 2518
- [ ]  2386. 找出数组的第 K 大和 2648 转化
- [ ]  1508. 子数组和排序后的区间和 思考：二分做法
- [ ]  1918. 第 K 小的子数组和（会员题）

## 三、其他

- [ ]  69. x 的平方根 二分求最大的 m，满足 m2≤x（也可以二分求最小的满足 m2\x 的 m，减一得到答案）
- [ ]  74. 搜索二维矩阵
- [ ]  240. 搜索二维矩阵 II
- [ ]  2476. 二叉搜索树最近节点查询
- [ ]  278. 第一个错误的版本
- [ ]  374. 猜数字大小
- [ ]  162. 寻找峰值
- [ ]  1901. 寻找峰值 II
- [ ]  852. 山脉数组的峰顶索引
- [ ]  1095. 山脉数组中查找目标值 1827
- [ ]  153. 寻找旋转排序数组中的最小值
- [ ]  154. 寻找旋转排序数组中的最小值 II
- [ ]  33. 搜索旋转排序数组
- [ ]  81. 搜索旋转排序数组 II
- [ ]  222. 完全二叉树的节点个数
- [ ]  1539. 第 k 个缺失的正整数
- [ ]  540. 有序数组中的单一元素
- [ ]  4. 寻找两个正序数组的中位数
- [ ]  1064. 不动点（会员题）
- [ ]  702. 搜索长度未知的有序数组（会员题）
- [ ]  2936. 包含相等值数字块的数量（会员题）
- [ ]  1060. 有序数组中的缺失元素（会员题）
- [ ]  1198. 找出所有行中最小公共元素（会员题）
- [ ]  1428. 至少有一个 1 的最左端列（会员题）
- [ ]  1533. 找到最大整数的索引（会员题）
- [ ]  2387. 行排序矩阵的中位数（会员题）
- [ ]  302. 包含全部黑色像素的最小矩形（会员题）

### 关联题单

二分答案的一个难点是 check 函数怎么写，这会涉及到贪心等技巧，可以练练下面的贪心题单（主要是第一章节）。


ref: https://leetcode.cn/discuss/post/3579164/ti-dan-er-fen-suan-fa-er-fen-da-an-zui-x-3rqn/
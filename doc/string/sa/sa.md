# 后缀数组




`sa[i]` 表示将所有后缀排序后第 i 小的后缀的编号，也是所说的后缀数组
`rk[i]` 表示后缀 i 的排名，是重要的辅助数组，后文也称排名数组 rk。
`height[i]=lcp(sa[i],sa[i-1])`，即第 i 名的后缀与它前一名的后缀的最长公共前缀

这两个数组满足性质：`sa[rk[i]] = rk[sa[i]] = i`。


## 算法


### O(n^2logn) 做法

将全部后缀字符串 sort 排序, 比较一次 `O(n)`，排序复杂度 `O(n log(n))`。  


### O(nlog^2n) 做法


主要用到倍增的思想，参考代码 [suffixArray.cpp](./suffixArray.cpp)。  


### O(nlogn) 做法


字符串值域固定，可以使用基数排序，复杂度优化到 `O(nlog(n))`  


### O(n) 做法

SA-IS
DC3


## 应用


- 寻找最小的循环移动位置
- 在字符串中找子串 
- 从字符串首尾取字符最小化字典序 - sa 数组
- 两子串最长公共前缀 - height 数组
- 比较一个字符串的两个子串的大小关系
- 不同子串的数目
- 出现至少 k 次的子串的最大长度
- 是否有某字符串在文本串中至少不重叠地出现了两次
- 连续的若干个相同子串


## 参考


https://oi-wiki.org/string/sa/
https://www.cnblogs.com/Garbage-fish/p/18873947

